<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ô</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- ‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô -->
  <div id="loginModal" class="modal">
    <div class="modal-content" style="max-width: 400px;">
      <h2 style="text-align: center; margin-bottom: 20px;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h2>
      <div style="margin-bottom: 15px;">
        <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö:</label>
        <input type="password" id="adminPassword" style="width: 100%; padding: 10px; border: 1px solid #d1fae5; border-radius: 6px;" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" />
      </div>
      <div style="display: flex; gap: 10px;">
        <button class="btn-primary" id="loginBtn" style="flex: 1;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (Admin)</button>
        <button class="btn-secondary" id="guestBtn" style="flex: 1;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°</button>
      </div>
      <div id="loginMessage" style="margin-top: 10px; text-align: center;"></div>
    </div>
  </div>

  <div class="container" id="mainApp" style="display: none;">
    <header>
      <img src="https://tkk911.github.io/Schedule_Manager_LTC/logoLTC.png" alt="LTC Logo" />
      <h2>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ô</h2>
      <h1>‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡πÅ‡∏´‡∏•‡∏°‡∏ó‡∏≠‡∏á</h1>
      <div class="sub">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå</div>
      <div class="term">
        ‡∏†‡∏≤‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:
        <input type="text" id="termInput" value="‡∏†‡∏≤‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà 2/2568" />
      </div>
      <div id="userInfo" style="margin-top: 10px; font-size: 14px; display: flex; justify-content: center; align-items: center; gap: 10px;">
        <span id="userStatus"></span>
        <button id="logoutBtn" class="btn-secondary small" style="display: none;">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </header>

    <div class="layout">
      <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤/‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå/ ‡πÄ‡∏ï‡πá‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô -->
      <div class="card">
        <h2>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤/‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå/ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
        <div id="tabArea" class="tabs">
          <div class="tab active" data-type="all">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏ß‡∏°</div>
          <div class="tab" data-type="teacher">‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå</div>
          <div class="tab" data-type="class">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡∏ä‡∏±‡πâ‡∏ô)</div>
          <div class="tab" data-type="room">‡∏´‡πâ‡∏≠‡∏á</div>
        </div>
        <div id="filterBox" style="margin-bottom:10px; display:none;">
          <select id="filterSelect" style="padding:6px; border-radius:6px; border:1px solid #ccc; width:200px;"></select>
        </div>
        <div class="grid-wrap">
          <table id="mainGrid">
            <thead>
              <tr>
                <th>‡∏ß‡∏±‡∏ô/‡πÄ‡∏ß‡∏•‡∏≤</th>
                <th>‡∏Ñ‡∏≤‡∏ö 1<div>(08:30-09:20)</div></th>
                <th>‡∏Ñ‡∏≤‡∏ö 2<div>(09:20-10:10)</div></th>
                <th>‡∏Ñ‡∏≤‡∏ö 3<div>(10:20-11:10)</div></th>
                <th>‡∏Ñ‡∏≤‡∏ö 4<div>(11:10-12:00)</div></th>
                <th>‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô<div>(12.00-12:50)</div></th>
                <th>‡∏Ñ‡∏≤‡∏ö 5<div>(12:50-13:40)</div></th>
                <th>‡∏Ñ‡∏≤‡∏ö 6<div>(13:40-14:30)</div></th>
                <th>‡∏Ñ‡∏≤‡∏ö 7<div>(14:30-15:20)</div></th>
              </tr>
            </thead>
            <tbody id="gridBody">				
            </tbody>
          </table>
        </div>
      </div>

      <!-- layout ‡πÄ‡∏î‡∏¥‡∏°: ‡∏ã‡πâ‡∏≤‡∏¢ (‡∏ü‡∏≠‡∏£‡πå‡∏°+‡∏™‡∏£‡∏∏‡∏õ) / ‡∏Ç‡∏ß‡∏≤ (‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î) -->
      <div style="display:grid;grid-template-columns:380px 1fr;gap:14px">
        <div>
          <div class="card" id="controls">
            <h2>‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô</h2>
            
            <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• JSON ‡πÅ‡∏•‡∏∞ Google Sheets -->
            <div style="display:flex;gap:8px;margin-bottom:15px;flex-wrap:wrap;">
              <button type="button" id="testConnectionBtn" class="btn-primary">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</button>
              <button type="button" id="saveLessonsBtn" class="btn-primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</button>
              <button type="button" id="saveAllFastBtn" class="btn-primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡πá‡∏ß</button>
              <button type="button" id="downloadJsonBtn" class="btn-primary">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î JSON</button>
              <button type="button" id="importJsonBtn" class="btn-secondary">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ JSON</button>
              <button type="button" id="exportToSheetsBtn" class="btn-primary">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Sheets</button>
              <button type="button" id="exportToSheetsChunkBtn" class="btn-info">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡πÅ‡∏ö‡πà‡∏á‡∏ä‡∏∏‡∏î</button>
              <button type="button" id="importFromSheetsBtn" class="btn-secondary">‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets</button>
              <button type="button" id="clearDataBtn" class="btn-danger" style="display:none;">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
              <button type="button" id="debugBtn" class="btn-info" style="display:none;">Debug ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
              <input type="file" id="jsonFileInput" accept=".json" style="display:none" />
            </div>
            
            <form id="lessonForm">
              <div class="row">
                <div style="flex:1">
                  <label>‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå</label>
                  <select id="teacher" required>
                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå</option>
                  </select>
                  <div class="data-management">
                    <h4>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå</h4>
                    <div class="input-group">
                      <input type="text" id="newTeacher" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå" />
                      <button type="button" class="btn-info" id="addTeacher">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
                    </div>
                    <div class="data-list" id="teacherList"></div>
                  </div>
                </div>
                <div style="flex:1">
                  <label>‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                  <select id="classLevel" required>
                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
                  </select>
                  <div class="data-management">
                    <h4>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h4>
                    <div class="input-group">
                      <input type="text" id="newClass" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" />
                      <button type="button" class="btn-info" id="addClass">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
                    </div>
                    <div class="data-list" id="classList"></div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div style="flex:1">
                  <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤</label>
                  <select id="subject" required>
                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤</option>
                  </select>
                  <div class="data-management">
                    <h4>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤</h4>
                    <div class="input-group">
                      <input type="text" id="newSubject" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤" />
                      <button type="button" class="btn-info" id="addSubject">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
                    </div>
                    <div class="data-list" id="subjectList"></div>
                  </div>
                </div>
                <div style="flex:1">
                  <label>‡∏´‡πâ‡∏≠‡∏á</label>
                  <select id="room" required>
                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á</option>
                  </select>
                  <div class="data-management">
                    <h4>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h4>
                    <div class="input-group">
                      <input type="text" id="newRoom" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á" />
                      <button type="button" class="btn-info" id="addRoom">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
                    </div>
                    <div class="data-list" id="roomList"></div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div style="flex:1">
                  <label>‡∏ß‡∏±‡∏ô</label>
                  <select id="day">
                    <option value="0">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</option>
                    <option value="1">‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£</option>
                    <option value="2">‡∏û‡∏∏‡∏ò</option>
                    <option value="3">‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ</option>
                    <option value="4">‡∏®‡∏∏‡∏Å‡∏£‡πå</option>
                  </select>
                </div>
                <div style="flex:1">
                  <label>‡∏Ñ‡∏≤‡∏ö</label>
                  <select id="period">
                    <option value="0">‡∏Ñ‡∏≤‡∏ö 1</option>
                    <option value="1">‡∏Ñ‡∏≤‡∏ö 2</option>
                    <option value="2">‡∏Ñ‡∏≤‡∏ö 3</option>
                    <option value="3">‡∏Ñ‡∏≤‡∏ö 4</option>
                    <option value="5">‡∏Ñ‡∏≤‡∏ö 5</option>
                    <option value="6">‡∏Ñ‡∏≤‡∏ö 6</option>
                    <option value="7">‡∏Ñ‡∏≤‡∏ö 7</option>
                  </select>
                </div>
              </div>
              <div class="row">
                <div style="flex:1">
                  <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≤‡∏ö</label>
                  <input type="number" id="numPeriods" value="1" min="1" max="7" />
                </div>
              </div>

              <div style="display:flex;gap:8px;margin-top:10px">
                <button class="btn-primary" type="submit" id="submitBtn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                <button type="button" id="autoBtn" class="btn-primary">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</button>
                <button type="button" id="resetBtn" class="btn-secondary">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
                <div style="margin-left:auto;display:flex;gap:6px">
                  <button type="button" id="exportBtn" class="btn-primary">Export Excel</button>
                  <button type="button" id="printBtn" class="btn-secondary">Print PDF</button>
                </div>
              </div>
              <div id="message" style="margin-top:10px"></div>
            </form>
          </div>

          <div class="card">
            <h3>‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏≤‡∏ö‡∏™‡∏≠‡∏ô (‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå) & ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡∏ï‡∏≤‡∏°‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ</h3>
            
            <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ó‡πá‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏£‡∏∏‡∏õ -->
            <div class="summary-tabs" style="display: flex; margin-bottom: 10px; border-bottom: 1px solid #d1fae5;">
              <div class="summary-tab active" data-type="teacher">‡∏™‡∏£‡∏∏‡∏õ‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå</div>
              <div class="summary-tab" data-type="class">‡∏™‡∏£‡∏∏‡∏õ‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ</div>
            </div>
            
            <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå (‡πÄ‡∏î‡∏¥‡∏°) -->
            <div id="teacherSummarySection">
              <div class="summary-controls" style="margin-bottom:10px;">
                <select id="teacherSummarySelect" style="padding:6px; border-radius:6px; border:1px solid #ccc; width:100%;">
                  <option value="all">‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                </select>
              </div>
              <div id="teacherSummary" class="summary small"></div>
            </div>
            
            <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ (‡πÉ‡∏´‡∏°‡πà) -->
            <div id="classSummarySection" style="display: none;">
              <div class="summary-controls" style="margin-bottom:10px;">
                <select id="classSummarySelect" style="padding:6px; border-radius:6px; border:1px solid #ccc; width:100%;">
                  <option value="all">‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                </select>
              </div>
              <div id="classSummary" class="summary small"></div>
            </div>
          </div>
        </div>

        <div>
          <div class="card">
            <h2>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
            
            <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
            <div class="filter-controls" style="margin-bottom: 15px; display: flex; gap: 10px; flex-wrap: wrap;">
              <div>
                <label>‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤:</label>
                <select id="filterSubject" style="padding: 6px; border-radius: 6px; border: 1px solid #ccc; width: 150px;">
                  <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                </select>
              </div>
              <div>
                <label>‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏£‡∏π:</label>
                <select id="filterTeacher" style="padding: 6px; border-radius: 6px; border: 1px solid #ccc; width: 150px;">
                  <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                </select>
              </div>
              <div>
                <label>‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏ä‡∏±‡πâ‡∏ô:</label>
                <select id="filterClass" style="padding: 6px; border-radius: 6px; border: 1px solid #ccc; width: 150px;">
                  <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                </select>
              </div>
              <div>
                <label>‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏´‡πâ‡∏≠‡∏á:</label>
                <select id="filterRoom" style="padding: 6px; border-radius: 6px; border: 1px solid #ccc; width: 150px;">
                  <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                </select>
              </div>
              <div>
                <label>‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô:</label>
                <select id="filterDay" style="padding: 6px; border-radius: 6px; border: 1px solid #ccc; width: 120px;">
                  <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                  <option value="0">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</option>
                  <option value="1">‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£</option>
                  <option value="2">‡∏û‡∏∏‡∏ò</option>
                  <option value="3">‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ</option>
                  <option value="4">‡∏®‡∏∏‡∏Å‡∏£‡πå</option>
                </select>
              </div>
              <div>
                <label>‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≤‡∏ö:</label>
                <select id="filterPeriod" style="padding: 6px; border-radius: 6px; border: 1px solid #ccc; width: 120px;">
                  <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                  <option value="0">‡∏Ñ‡∏≤‡∏ö 1</option>
                  <option value="1">‡∏Ñ‡∏≤‡∏ö 2</option>
                  <option value="2">‡∏Ñ‡∏≤‡∏ö 3</option>
                  <option value="3">‡∏Ñ‡∏≤‡∏ö 4</option>
                  <option value="5">‡∏Ñ‡∏≤‡∏ö 5</option>
                  <option value="6">‡∏Ñ‡∏≤‡∏ö 6</option>
                  <option value="7">‡∏Ñ‡∏≤‡∏ö 7</option>
                </select>
              </div>
              <div style="align-self: end;">
                <button type="button" id="resetFilterBtn" class="btn-secondary" style="padding: 6px 12px;">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á</button>
              </div>
            </div>
            
            <table id="lessonTable">
              <thead>
                <tr><th>‡∏ß‡∏¥‡∏ä‡∏≤</th><th>‡∏Ñ‡∏£‡∏π</th><th>‡∏ä‡∏±‡πâ‡∏ô</th><th>‡∏´‡πâ‡∏≠‡∏á</th><th>‡∏ß‡∏±‡∏ô</th><th>‡∏Ñ‡∏≤‡∏ö</th><th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h3 id="modalTitle">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
      <input type="text" id="editInput" />
      <div style="display:flex;gap:8px;margin-top:15px">
        <button class="btn-primary" id="saveEditBtn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        <button class="btn-secondary" id="cancelEditBtn">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
      </div>
    </div>
  </div>

  <!-- Loading Spinner (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß) -->
  <div id="loading" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); justify-content: center; align-items: center; z-index: 9999; color: white; font-size: 18px; flex-direction: column;">
    <div style="background: white; padding: 30px; border-radius: 10px; color: black; display: flex; align-items: center; gap: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); flex-direction: column;">
      <div class="loading-spinner" style="border: 4px solid #f3f3f3; border-top: 4px solid #10b981; border-radius: 50%; width: 40px; height: 40px; animation: spin 2s linear infinite;"></div>
      <div style="text-align: center;">
        <div style="font-weight: bold; margin-bottom: 5px;">üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
        <div style="font-size: 14px; color: #666; margin-bottom: 10px;">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà</div>
        <button onclick="forceHideLoading()" style="padding: 8px 16px; background: #ef4444; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: bold;">
          üö´ ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î
        </button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
